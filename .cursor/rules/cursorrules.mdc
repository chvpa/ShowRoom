---
description: 
globs: 
alwaysApply: true
---
# Contenido de tu regla

# Regla de Cursor â€“ ShowRoom: Manejo de datos de alto rendimiento y escalabilidad

## ğŸ“¦ Reglas para la obtenciÃ³n de datos (Data fetching)

- âœ… Utilizar siempre **estrategias eficientes de obtenciÃ³n de datos**:
  - Implementar **cachÃ© del lado del cliente** con SWR o React Query (si estÃ¡ disponible).
  - Obtener **Ãºnicamente** los datos necesarios, evitar sobrecarga de peticiones.
  - Usar **consultas selectivas**: evitar SELECT *.
  - Obtener datos de forma perezosa (lazy loading), bajo demanda.
  - Evitar mÃºltiples solicitudes innecesarias a Supabase.

- âœ… Utilizar **consultas paginadas** para conjuntos de datos grandes:
  - Implementar limit y offset para las listas.
  - Mostrar indicadores de carga al obtener las siguientes pÃ¡ginas.
  - Soportar scroll infinito o paginaciÃ³n en la interfaz.

- âœ… Preferir la **paginaciÃ³n y filtrado en el servidor** antes que en el cliente:
  - Aplicar filtros y ordenamientos en la consulta, no en el frontend.
  - Validar y sanitizar siempre los parÃ¡metros de consulta.

- âœ… Usar **consultas por lotes** al obtener mÃºltiples elementos (batching).

- âœ… Aplicar debounce en los campos de bÃºsqueda o filtros para evitar mÃºltiples peticiones rÃ¡pidas.

---

## ğŸš€ CachÃ© y rendimiento de datos

- âœ… Usar la **cachÃ© de forma agresiva**:
  - Implementar SWR (stale-while-revalidate) o una estrategia de cachÃ© similar.
  - Revalidar datos de manera inteligente (invalidaciÃ³n manual cuando sea necesario).
  - Cachear correctamente los assets estÃ¡ticos e imÃ¡genes.
  - Priorizar el almacenamiento local o IndexedDB para cachÃ© persistente si es beneficioso.

- âœ… Aplicar **memoizaciÃ³n** para cÃ¡lculos y componentes costosos.

- âœ… Usar **React.memo**, `useMemo` y `useCallback` para componentes y utilidades pesadas.

- âœ… Prefetch de datos **antes de que se necesiten**, especialmente para flujos conocidos (selecciÃ³n de marca â†’ rubro â†’ producto).

---

## âš™ï¸ Mejores prÃ¡cticas para manejo de base de datos (Supabase)

- âœ… Evitar SELECT * en producciÃ³n. Siempre especificar los campos requeridos.
- âœ… Usar **Row Level Security (RLS) de Supabase** para la seguridad de los datos.
- âœ… Aplicar **filtrado, paginaciÃ³n y ordenamiento del lado del servidor**.
- âœ… Reducir lecturas mediante la cachÃ© de metadatos de uso frecuente (ej.: marcas, rubros).
- âœ… Evitar consultas anidadas innecesarias.
- âœ… Preparar para **regeneraciÃ³n incremental** si se considera SSR en el futuro.
- âœ… DiseÃ±ar el esquema para **rendimiento Ã³ptimo de consultas**:
  - IndexaciÃ³n adecuada.
  - Evitar problemas de N+1.
  - Utilizar joins eficientes.

---

## ğŸ§© Experiencia de usuario con grandes volÃºmenes de datos

- âœ… Utilizar **skeleton loaders** y placeholders para mejorar la percepciÃ³n de rendimiento.
- âœ… Implementar scroll virtual si las listas son muy largas (ej.: mÃ¡s de 500 elementos).
- âœ… Mostrar datos en fragmentos ("cargar mÃ¡s" o scroll infinito).
- âœ… Cargar de forma perezosa (lazy load) imÃ¡genes y recursos pesados.
- âœ… Comprimir imÃ¡genes y usar formatos modernos (WebP, AVIF).

---

## ğŸ§± Estructura de cÃ³digo para el rendimiento

- âœ… Dividir el cÃ³digo por rutas y caracterÃ­sticas (code-splitting).
- âœ… Usar imports dinÃ¡micos y React.lazy donde sea aplicable.
- âœ… Evitar la contaminaciÃ³n del estado global.
- âœ… Minimizar re-renderizados mediante una gestiÃ³n adecuada del estado.
- âœ… Mantener Ã¡rboles de componentes poco profundos siempre que sea posible.

---

## ğŸ›¡ï¸ Consideraciones de seguridad para el flujo de datos

- âœ… Sanitizar y validar todas las entradas, tanto del lado del cliente como del servidor.
- âœ… No exponer consultas o variables sensibles en el cÃ³digo del frontend.
- âœ… Nunca almacenar claves de API o secretos en JS del lado del cliente.
- âœ… Usar variables de entorno de manera segura.
- âœ… Aplicar permisos estrictos en las policies de Supabase.

---

## ğŸ§  Recordatorio para Cursor AI

> - Priorizar siempre las consultas eficientes sobre la conveniencia.
> - Cachear las respuestas siempre que sea apropiado.
> - Evitar la obtenciÃ³n innecesaria de datos y combinar solicitudes de forma lÃ³gica.
> - Mantener el flujo de datos limpio, predecible y seguro.
> - Enfocarse en la performance percibida (UX rÃ¡pida como prioridad).
> - Pensar en la escalabilidad: la aplicaciÃ³n debe manejar miles de productos y usuarios sin problemas.
> - Siempre haz todo en ESPAÃ‘OL

---

## ğŸŒŸ PreparaciÃ³n para el futuro (Altamente recomendado)

- Preparar soporte **offline** con service workers.
- Considerar optimizaciÃ³n **PWA** para una experiencia mÃ³vil fluida.
- Usar hints de **preload** y **preconnect** en `<head>` para recursos crÃ­ticos.
- Configurar **extracciÃ³n de CSS crÃ­tico** para una pintura inicial mÃ¡s rÃ¡pida.
- Utilizar **lazy hydration** para componentes no crÃ­ticos.

---

